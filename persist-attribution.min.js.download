!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";var c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};const o=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),s=e=>encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent),i=decodeURIComponent,a=e=>(e='"'===e[0]?e.slice(1,-1):e).replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);function l(e,t,r){const n=/(?:^|; )([^=]*)=([^;]*)/g,i={};for(var o;null!=(o=n.exec(document.cookie));)try{var s=r(o[1]);if(i[s]=t(o[2],s),e===s)break}catch(e){}return null!=e?i[e]:i}var e=Object.freeze({decodeName:i,decodeValue:a,encodeName:o,encodeValue:s});const d=Object.freeze({path:"/"});function u(e,t,r=d,{encodeValue:n=s,encodeName:i=o}={}){return document.cookie=i(e)+"="+n(t,e)+(i=r,"number"==typeof(i=Object.assign({},i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),null!=i.expires&&(i.expires=i.expires.toUTCString()),Object.entries(i).filter(([,e])=>null!=e&&!1!==e).map(([e,t])=>!0===t?"; "+e:`; ${e}=`+t.split(";")[0]).join(""))}function f(e,{decodeValue:t=a,decodeName:r=i}={}){return l(e,t,r)}function m(e,t=d){u(e,"",Object.assign({},t,{expires:-1}))}!function t(e,r){var n={set:function(e,t,r){return u(e,t,Object.assign({},this.attributes,r),{encodeValue:this.converter.write})},get:function(e){return 0===arguments.length?([{decodeValue:t=a,decodeName:r=i}={}]=[this.converter.read],l(void 0,t,r)):null!=e?f(e,this.converter.read):void 0;var t,r},remove:function(e,t){m(e,Object.assign({},this.attributes,t))},withAttributes:function(e){return t(this.converter,Object.assign({},this.attributes,e))},withConverter:function(e){return t(Object.assign({},this.converter,e),this.attributes)}},r={attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(e)}};return Object.create(n,r)}({read:e.decodeValue,write:e.encodeValue},d);var p="b_visitor",v="b_referrer",b="b_initial_referrer",h=18e5,g=315576e6,w=["utm_medium","utm_campaign","utm_source"],O=Object.freeze({persistUtms:!0,persistVisitorId:!0,persistReferrer:!0,persistInitialReferrer:!0,sendPageViewEvents:!1});function j(e){var t=e.persistUtms,r=e.persistVisitorId,n=e.persistReferrer,e=e.persistInitialReferrer,i={path:"/",domain:".builder.io",expires:new Date((new Date).getTime()+h)},o=c(c({},i),{expires:new Date((new Date).getTime()+g)}),s=new URL(""+window.location),t=(t&&w.forEach(function(e){var t=s.searchParams.get(e);t?u("b_"+e,t,i):m("b_"+e)}),r&&(f(p)||u(p,function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=t.length,n="",i=0;i<e;i++)n+=t.charAt(Math.floor(Math.random()*r));return n}(32),o)),document.referrer);try{var a=new URL(document.referrer).hostname;!/(partytown|qwik).builder.io$/i.test(a)&&a.endsWith("builder.io")||(n&&u(v,t,i),e&&!f(b)&&u(b,t,o))}catch(e){}}function n(e,t){if(void 0===e)return t;try{var r=JSON.parse(e.toLowerCase());return"boolean"==typeof r?r:t}catch(e){return t}}function R(e){var t=new Date,r=f(p);return r?fetch("https://cdn.builder.io/api/v1/event",{method:"POST",body:JSON.stringify({events:[{name:"pageView",data:c(c({referrer:document.referrer,url:""+location,timestamp:t.getTime(),date:""+t},e),{visitorId:r})}]}),headers:{"content-type":"application/json; charset=utf-8"}}).then(function(){}):Promise.resolve()}function t(){var t,e=document.getElementById("persist-attribution-init");function r(e){return t.dataset[e]}j(e=e?(t=e,{persistUtms:n(r("persistUtms"),!0),persistVisitorId:n(r("persistVisitorId"),!0),persistReferrer:n(r("persistReferrer"),!0),persistInitialReferrer:n(r("persistInitialReferrer"),!0),sendPageViewEvents:n(r("sendPageViewEvents"),!1)}):O),e.sendPageViewEvents&&(R(),window.addEventListener("clientRoute",R))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t()});
//# sourceMappingURL=persist-attribution.min.js.map
